---
layout: default
lang: jp
nav_link: コマンドライン
nav_level: 2
nav_order: 310
---

# 最終的なコマンドラインオプションの選択

[前の節](monitoring.md) \| [目次に戻る](index.md) \|  [次の節](scheduling.md)

User Sync のコマンドラインでは、処理するユーザーのセットを選択し、ユーザーグループや製品プロファイルのメンバーシップを管理する必要があるかどうかや、アカウントの削除の処理方法およびいくつかの追加オプションを指定します。

## ユーザー


| ユーザーコマンドラインオプション  | 用途           |
| ------------- |:-------------| 
|   `--users all` |    ディレクトリに一覧されているすべてのユーザーが対象となります。 |
|   `--users group "g1,g2,g3"`  |    指定したディレクトリグループを使用してユーザーの選択を構成します。<br>いずれかのグループのメンバーであるユーザーが対象となります。 |
|   `--users mapped`  |    `--users group g1,g2,g3,...` と同じです。`g1,g2,g3,...` は、構成ファイルグループマッピングで指定されているすべてのディレクトリグループです。|
|   `--users file f`  |    ファイル f が読み取られて、選択したユーザーセットを構成します。この場合、LDAP ディレクトリは使用されません。 |
|   `--user-filter pattern`    |  上記のオプションと組み合わせて、ユーザーの選択範囲をさらにフィルタリングし、縮小できます。<br>`pattern` は、Python 正規表現形式の文字列です。<br>ユーザー名を含めるには、そのユーザー名がパターンと一致する必要があります。<br>パターンの記述には多少のテクニックが必要です。以下の例を参照するか、[ここ](https://docs.python.org/2/library/re.html)で Python のドキュメントを参照してください。 |


ディレクトリに一覧されているすべてのユーザーを Adobe と同期する場合は、`--users all` を使用します。一部のユーザーだけの場合は、`connector-ldap.yml` 構成ファイルで LDAP クエリを変更（また、`--users all` を使用）して設定を制限するか、（--users group を使用して）特定のグループ内のユーザーに制限することができます。これらのいずれかを `--user-filter pattern` と組み合わせて、同期するユーザーの選択したセットをさらに制限できます。

ディレクトリシステムを使用していない場合は、`--users file f` を使用して csv ファイルからユーザーを選択できます。形式を確認するには、ユーザーファイルの例（csv inputs - user and remove lists/users-file.csv）を参照してください。csv ファイルに一覧されているグループは、選択できる名前です。これらは、ディレクトリグループと同じ方法で Adobe ユーザーグループや製品プロファイルにマップされます。

## 


同期で製品ライセンスを管理していない場合は、構成ファイルでグループマップを指定する必要はなく、グループ処理用にコマンドラインパラメーターを追加する必要はありません。

User Sync でライセンスを管理している場合は、コマンドラインに `--process-groups` オプションを含めます。


## アカウントの削除


対応するディレクトリアカウントがない Adobe アカウントが見つかった場合（「Adobe のみ」のユーザー）に実行するアクションを指定できるコマンドラインオプションがいくつかあります。
ディレクトリクエリとフィルターによって返されたユーザーのみがエンタープライズディレクトリに「存在する」とみなされます。これらのオプションは「完全に無視」から「完全に削除」までで、その間にいくつかの可能性があります。



| コマンドラインオプション       ...........| 用途           |
| ------------- |:-------------| 
|   `--adobe-only-user-action exclude`                        |  Adobe にのみ存在し、対応するディレクトリアカウントを持たないアカウントではアクションを実行しません。`--process-groups` が存在する場合でも、Adobe グループのメンバーシップは更新されません。 |
|   `--adobe-only-user-action preserve`                        |  Adobe にのみ存在し、対応するディレクトリアカウントを持たないアカウントは除去または削除しません。`--process-groups` が存在する場合、Adobe グループのメンバーシップは更新されます。 |
|   `--adobe-only-user-action remove-adobe-groups` |    Adobe アカウントは残りますが、ライセンスとグループの<br>メンバーシップは除去されます。 |
|   `--adobe-only-user-action remove`  |    Adobe アカウントは残りますが、ライセンス、グループメンバーシップ、Adobe Admin console 内のリストは除去されます。   |
|   `--adobe-only-user-action delete`  |    削除する Adobe アカウント：アドビ製品構成とユーザーグループから<br>除去します。アカウントは削除され、すべてのストレージと設定が解放されます。 |
|   `--adobe-only-user-action write-file f.csv`    |  アカウントに対してアクションは実行されません。後でアクションを実行するためにユーザー名がファイルに書き込まれます。 |




## その他のオプション

`--test-mode`：User Sync は要求を処理するためにディレクトリのクエリや Adobe ユーザー管理 API の呼び出しなどのすべての処理を通じて実行されますが、実際のアクションは実行されません。ユーザーは作成、削除または変更されません。

`--update-user-info`：User Sync はユーザーの姓、名または電子メールアドレスの変更を確認し、ディレクトリ情報と一致しない場合は Adobe 情報をアップデートします。このオプションを指定すると、実行時間が長くなることがあります。


## サンプル

例えば、次のようなアプリがあります。 

`user-sync --users all --process-groups --adobe-only-user-action remove`

- 構成設定に基づいてすべてのユーザーを処理し、Adobe グループのメンバーシップをアップデートします。ディレクトリにない Adobe ユーザーがいる場合はそのユーザーを Adobe 側から除去して、割り当てられていたライセンスを解放します。Adobe アカウントは削除されないので、再び追加したり、保存したアセットを復元したりできます。
    
`user-sync --users file users-file.csv --process-groups --adobe-only-user-action remove`

- ファイル「users-file.csv」がマスターユーザーリストとして読み込まれます。この場合、Active Directory や LDAP などのディレクトリサービスへのアクセスは試行されません。Adobe グループのメンバーシップはファイル内の情報に従ってアップデートされ、ファイルにない Adobe アカウントは除去されます（前述の除去の定義を参照）。

## コマンドラインを定義します。

削除オプションを指定せずに最初のいくつかの実行を行うことができます。

&#9744;User Sync の実行に必要なコマンドラインオプションを統合します。


[前の節](monitoring.md) \| [目次に戻る](index.md) \|  [次の節](scheduling.md)
